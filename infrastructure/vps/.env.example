# Civic OS VPS Environment Configuration
# Copy to .env and fill in your values

# =============================================================================
# REQUIRED: Domain Configuration
# =============================================================================
# Your application domain (without protocol)
# All services are accessed via path-based routing on this single domain:
#   - Frontend: https://${APP_DOMAIN}/
#   - API:      https://${APP_DOMAIN}/_/api/
#   - Docs:     https://${APP_DOMAIN}/_/docs/
APP_DOMAIN=demo.civic-os.app

# Optional: Vanity domain for user-facing URLs
# When set, browser traffic to APP_DOMAIN redirects to VANITY_DOMAIN.
# API/docs paths on APP_DOMAIN continue to work without redirect.
# VANITY_DOMAIN=friendly-name.org
# SITE_URL=https://friendly-name.org

# =============================================================================
# REQUIRED: Database Configuration (Managed PostgreSQL)
# =============================================================================
# Get these from your DigitalOcean Managed Database console
DB_HOST=db-postgresql-nyc1-xxxxx-do-user-xxxxx-0.l.db.ondigitalocean.com
DB_PORT=25060
DB_NAME=civic-os
DB_USER=doadmin
DB_PASSWORD=your-database-password
SSLMODE=require

# Authenticator role password (set during initial database setup)
AUTHENTICATOR_PASSWORD=your-authenticator-password

# =============================================================================
# REQUIRED: Keycloak Authentication
# =============================================================================
KEYCLOAK_URL=https://auth.civic-os.org
KEYCLOAK_REALM=civic-os
KEYCLOAK_CLIENT_ID=civic-os-client

# =============================================================================
# REQUIRED: S3/Spaces Storage (for file uploads)
# =============================================================================
# DigitalOcean Spaces or AWS S3
S3_ENDPOINT=https://nyc3.digitaloceanspaces.com
S3_PUBLIC_ENDPOINT=https://your-space.nyc3.digitaloceanspaces.com
S3_BUCKET=civic-os-files
S3_ACCESS_KEY_ID=your-spaces-key
S3_SECRET_ACCESS_KEY=your-spaces-secret
S3_REGION=us-east-1

# =============================================================================
# REQUIRED: Email (Notifications)
# =============================================================================
# AWS SES or other SMTP provider
SMTP_HOST=email-smtp.us-east-1.amazonaws.com
SMTP_PORT=587
SMTP_USERNAME=your-smtp-username
SMTP_PASSWORD=your-smtp-password
SMTP_FROM='"Civic OS" <noreply@your-domain.com>'
NOTIFICATION_TIMEZONE=America/New_York

# =============================================================================
# OPTIONAL: Container Images
# =============================================================================
# GitHub organization for container images (default: civic-os)
GITHUB_ORG=civic-os
# Version tag (default: latest)
VERSION=latest

# =============================================================================
# OPTIONAL: Stripe Payments
# =============================================================================
# Only needed if using payment features
# Get keys from: https://dashboard.stripe.com/apikeys
# STRIPE_API_KEY=sk_live_xxxxx
# STRIPE_PUBLISHABLE_KEY=pk_live_xxxxx
# STRIPE_WEBHOOK_SECRET=whsec_xxxxx
# PAYMENT_CURRENCY=USD

# =============================================================================
# OPTIONAL: Map Configuration
# =============================================================================
# Default map center (Flint, MI)
MAP_DEFAULT_LAT=43.0125
MAP_DEFAULT_LNG=-83.6875
MAP_DEFAULT_ZOOM=13

# Custom tile server (default: OpenStreetMap)
# MAP_TILE_URL=https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png
# MAP_ATTRIBUTION=&copy; <a href='https://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors

# =============================================================================
# OPTIONAL: Analytics
# =============================================================================
# Matomo analytics (self-hosted or cloud)
# MATOMO_URL=https://analytics.your-domain.com
# MATOMO_SITE_ID=1
# MATOMO_ENABLED=true

# =============================================================================
# OPTIONAL: Worker Configuration
# =============================================================================
# Database connection pool
DB_MAX_CONNS=4
DB_MIN_CONNS=1

# Thumbnail generation workers (adjust based on RAM)
# 2GB RAM: 3-5 workers, 4GB RAM: 7-10 workers
THUMBNAIL_MAX_WORKERS=5

# Skip sending to @example.com addresses (for testing)
SKIP_TEST_EMAILS=true

# =============================================================================
# OPTIONAL: Logging
# =============================================================================
POSTGREST_LOG_LEVEL=info
