# Copyright (C) 2023-2025 Civic OS, L3C
# AGPL-3.0-or-later

# IMPORTANT: This is a TEMPLATE ONLY - DO NOT commit actual secrets to git!
#
# This file shows the structure but should NOT be applied directly.
# Instead, create secrets using one of these methods:

# Method 1: kubectl create (for development/testing)
# ------------------------------------------------------
# For managed external database and S3 storage (recommended):
#
#   kubectl create secret generic civic-os-secrets \
#     --from-literal=DATABASE_URL='postgresql://user:pass@host:port/dbname?sslmode=require' \
#     --from-literal=S3_ACCESS_KEY_ID='your-access-key-id' \
#     --from-literal=S3_SECRET_ACCESS_KEY='your-secret-access-key' \
#     --namespace civic-os
#
# Example for Digital Ocean managed PostgreSQL:
#   DATABASE_URL='postgresql://doadmin:password@db-postgresql-nyc3-12345.ondigitalocean.com:25060/defaultdb?sslmode=require'
#
# Example for AWS S3:
#   S3_ACCESS_KEY_ID='AKIAIOSFODNN7EXAMPLE'
#   S3_SECRET_ACCESS_KEY='wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY'

# Method 2: Sealed Secrets (RECOMMENDED for production)
# -------------------------------------------------------
# Sealed Secrets encrypts secrets so they can be safely committed to git
#
# 1. Install Sealed Secrets controller:
#    kubectl apply -f https://github.com/bitnami-labs/sealed-secrets/releases/download/v0.24.0/controller.yaml
#
# 2. Install kubeseal CLI:
#    brew install kubeseal  # or download from GitHub releases
#
# 3. Create a regular secret file (secrets-temp.yaml):
#    apiVersion: v1
#    kind: Secret
#    metadata:
#      name: civic-os-secrets
#      namespace: civic-os
#    type: Opaque
#    stringData:
#      DATABASE_URL: "postgresql://user:pass@host:port/dbname?sslmode=require"
#      S3_ACCESS_KEY_ID: "your-access-key-id"
#      S3_SECRET_ACCESS_KEY: "your-secret-access-key"
#
# 4. Encrypt it with namespace-wide scope:
#    kubeseal --controller-namespace=kube-system \
#             --scope namespace-wide \
#             --format=yaml < secrets-temp.yaml > sealed-secrets.yaml
#
# 5. Delete the temp file and commit sealed-secrets.yaml:
#    rm secrets-temp.yaml
#    git add sealed-secrets.yaml
#
# IMPORTANT: Use --scope namespace-wide if using Kustomize namePrefix
# Otherwise the sealed secret won't decrypt after name transformation

# Method 3: External secret management (for production)
# -------------------------------------------------------
# - External Secrets Operator (https://external-secrets.io/)
# - HashiCorp Vault
# - AWS Secrets Manager / GCP Secret Manager / Azure Key Vault

---
# TEMPLATE STRUCTURE (for reference only):
apiVersion: v1
kind: Secret
metadata:
  name: civic-os-secrets
  namespace: civic-os
type: Opaque
stringData:
  # Database connection (REQUIRED)
  # For managed external database (production - RECOMMENDED)
  DATABASE_URL: "postgresql://user:password@host:port/dbname?sslmode=require"

  # S3/File Storage credentials (REQUIRED for v0.10.0+ file upload features)
  S3_ACCESS_KEY_ID: "your-access-key-id"
  S3_SECRET_ACCESS_KEY: "your-secret-access-key"
